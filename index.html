<!DOCTYPE html>
<html>
<head>
	<title>Smash Up Race Distributor</title>
	<meta charset="UTF-8">
	<link rel="stylesheet" type="text/css" href="style.css">
	<link href='https://fonts.googleapis.com/css?family=Lobster+Two:700' rel='stylesheet' type='text/css'>
	<link href='https://fonts.googleapis.com/css?family=Exo:400,700' rel='stylesheet' type='text/css'>
	<script src="jquery-1.12.3.min.js"></script>
</head>
<body>
	<div class="overbackground">
		<h1>Smash Up Race Distributor</h1>
		<div class="content">
			<form>
				<div class="form-group">
					<div id="playerNumber">
					    <label>Combien de joueurs ?</label>
					    <input type="number" id="playerNumberInput" placeholder="Entrez le nombre de joueurs"></input>
						</br>
					    <button type="button">Entrer</button>
					</div>
					</br></br>
				    <div id="playerfield1">
					    <label>Nom du joueur 1 ?</label>
					    <input type="text" id="player1" placeholder="Entrez le nom du joueur 1">
					</div>
					<div id="playerfield2">
					    <label>Nom du joueur 2 ?</label>
					    <input type="text" id="player2" placeholder="Entrez le nom du joueur 2">
				    </div>
				    <div id="playerfield3">
					    <label>Nom du joueur 3 ?</label>
					    <input type="text" id="player3" placeholder="Entrez le nom du joueur 3">
				    </div>
				    <div id="playerfield4">
					    <label>Nom du joueur 4 ?</label>
					    <input type="text" id="player4" placeholder="Entrez le nom du joueur 4">
				    </div>
				    <div id="extensions">
				    	<p>Jouer avec :</p>
				    	<input type="checkbox" name="serieB">Série B</input>
				    	</br>
				    	<input type="checkbox" name="monstre">Monstres</input>
				    	</br>
				    	<input type="checkbox" name="minion">Trop minions</input>
				    	</br>
				    </div>
				    <button type="button" id="resultButton">Entrer</button>
				    <div id="results">
				    </div>
			  	</div>
			</form>
		</div>
	</div>

<script>
	var racesBase = ["Pirates", "Ninja", "Zombies", "Robots", "Dinosaures", "Sorciers", "Petit Peuple", "Aliens"];
	var serieBRaces = ["Voyageurs du temps", "Singes cyborgs", "Métamorphes", "Super espions"];
	var monstreRaces = ["Vampires", "Fourmis géantes", "Loups-garous", "Savants fous"];
	var minionRaces = ["Chats", "Fées", "Poneys", "Princesses"];
	var races = racesBase;

	$("#playerfield1").hide();
	$("#playerfield2").hide();
	$("#playerfield3").hide();
	$("#playerfield4").hide();
	$("#resultButton").hide();
	$("#extensions").hide();
	$("#results").hide();
	
	var playerNumber = document.getElementById("playerNumberInput");
	var playerNames = [];

	playerNumber.addEventListener("keydown", function(e) {
		if(e.keyCode == 13) {
			askNames(playerNumberInput.value);
		}
	});

	$("#playerNumber button").click(function() {
		askNames(playerNumberInput.value);
	});

	player2.addEventListener("keydown", function(e) {
		if(e.keyCode == 13) {
			isExtensionSelected();
			giveResults(playerNumber.value);
		}
	});

	$("#resultButton").click(function() {
		isExtensionSelected();
		giveResults(playerNumber.value);
	});

	function askNames(number) {
		$("#playerNumber").hide();
		for(i = 1; i <= number; ++i) {
			$("#playerfield"+i).show();
		}
		$("#extensions").show();
		$("#resultButton").show();
	};

	function isExtensionSelected() {
		if($("input[name=serieB]").is(":checked")) {
			races = races.concat(serieBRaces);
		}
		if($("input[name=monstre]").is(":checked")) {
			races = races.concat(monstreRaces);
		}
		if($("input[name=minion]").is(":checked")) {
			races = races.concat(minionRaces);
		}
	};

	function giveResults(numberOfPlayers) {
		for(i = 1; i <= numberOfPlayers; ++i) {
			playerNames[i] = document.getElementById("player" + i).value;
			var playerRaces = get2RandomRaces();
			var string = "<span class=\"playerName\">" + playerNames[i] 
				+ "</span> jouera <span class=\"playedRace\">" + playerRaces[0] 
				+ "</span> et <span class=\"playedRace\">" + playerRaces[1] + "</span>";
			$("#results").append(string + "</br>");
			$("#results").show();
		}
	};

	function get2RandomRaces() {
		var choices = [];
		var firstRace = Math.floor(Math.random() * races.length);
		choices[0] = races.splice(firstRace, 1);

		var secondRace;
		do {
			secondRace = Math.floor(Math.random() * races.length);
		} while(secondRace == firstRace);
		choices[1] = races.splice(secondRace, 1);

		return choices;
	};
</script>
</body>
</html>